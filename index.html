<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pen Plotter Photo → G-code</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Pen Plotter — Photo → G-code</h1>
    <p>Upload a photo, tune conversion settings, preview the pen strokes, and download G-code and a preview image.</p>
  </header>

  <main>
    <section id="controls">
      <label>Image file
        <input id="file" type="file" accept="image/*" />
      </label>

      <label>Width (mm)
        <input id="widthMM" type="number" value="150" min="1" />
      </label>

      <label>Resolution (px / mm)
        <input id="pxPerMM" type="number" value="3" min="0.5" step="0.1" />
        <small>higher → more detail and bigger G-code</small>
      </label>

      <label>Line spacing (mm)
        <input id="lineSpacingMM" type="number" value="0.5" min="0.1" step="0.1" />
      </label>

      <label>Threshold (0–255)
        <input id="threshold" type="range" min="0" max="255" value="128" />
        <span id="thresholdVal">128</span>
      </label>

      <label>Rotation / hatch angle (degrees)
        <input id="angle" type="number" value="0" min="0" max="359" />
      </label>

      <label>Repeat passes (for cross-hatching)
        <input id="passes" type="number" value="1" min="1" max="4" />
      </label>

      <fieldset>
        <legend>G-code / Pen params</legend>
        <label>Pen down Z (mm)
          <input id="penDownZ" type="number" value="0" step="0.1" />
        </label>
        <label>Pen up Z (mm)
          <input id="penUpZ" type="number" value="5" step="0.1" />
        </label>
        <label>Travel feed (mm/min)
          <input id="feedTravel" type="number" value="6000" />
        </label>
        <label>Draw feed (mm/min)
          <input id="feedDraw" type="number" value="2000" />
        </label>
        <label>Use absolute moves
          <input id="absMoves" type="checkbox" checked />
        </label>
      </fieldset>

      <div class="buttons">
        <button id="processBtn" disabled>Process & Preview</button>
        <button id="downloadPNG" disabled>Download Preview PNG</button>
        <button id="downloadGcode" disabled>Download G-code</button>
      </div>

      <p class="notes">
        Notes: This app generates horizontal raster strokes across the (rotated) image, turning pen down when pixels are dark. Multiple passes at different angles can simulate cross-hatching. Coordinates are in millimeters. Origin is top-left (X right, Y down); if your plotter expects a different origin, you may translate/flip the output or change the conversion in app.js.
      </p>
    </section>

    <section id="preview">
      <h2>Preview</h2>
      <canvas id="previewCanvas"></canvas>
      <h3>Rendered strokes (zoomed)</h3>
      <div id="meta"></div>
    </section>
  </main>

  <footer>
    <small>Made for pen plotters — default pen up/down via Z moves (G0 Z...). Customize in the controls.</small>
  </footer>

  <script src="app.js"></script>
</body>
</html>
